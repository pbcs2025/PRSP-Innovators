# Setup Guide

## Step-by-Step Setup Instructions

### 1. Prerequisites

Ensure you have the following installed:
- **Node.js 18+** - [Download](https://nodejs.org/)
- **MongoDB** - [Download](https://www.mongodb.com/try/download/community) or use MongoDB Atlas
- **Redis** - [Download](https://redis.io/download) or use Redis Cloud

### 2. Backend Setup

```bash
# Navigate to backend directory
cd backend

# Install dependencies
npm install

# Generate secure keys
node generate-keys.js

# Copy the generated keys to a new .env file
# Create .env file manually with the following structure:
```

Create `backend/.env` file with:

```env
PORT=5000
MONGO_URI=mongodb://localhost:27017/kyc_db
REDIS_URL=redis://localhost:6379

# Paste the keys generated by generate-keys.js
SERVER_INDEX_KEY=<64-char-hex-key>
MASTER_KEY=<64-char-hex-key>
JWT_SECRET_KEY=<base64-secret>
SHARED_CLIENT_KEY=<64-char-hex-key>
```

### 3. Start MongoDB and Redis

**For Windows users:** See `WINDOWS_SETUP.md` for detailed instructions!

**Quick options:**
- **Easiest:** Use MongoDB Atlas (cloud) + Redis Cloud (cloud) - no installation needed!
- **Local:** Install MongoDB Community Server + Redis via WSL2 or Memurai

**MongoDB:**
```bash
# On macOS/Linux (if installed via Homebrew)
brew services start mongodb-community

# On Windows - see WINDOWS_SETUP.md
# Or use MongoDB Atlas (cloud) - recommended for Windows!

# Test connection:
cd backend
node test-connection.js
```

**Redis:**
```bash
# On macOS/Linux
redis-server

# On Windows - see WINDOWS_SETUP.md
# Or use Redis Cloud (cloud) - recommended for Windows!

# Test connection:
cd backend
node test-connection.js
```

### 4. Test Database Connections

```bash
cd backend
node test-connection.js
```

This will verify MongoDB and Redis are accessible. If MongoDB fails, fix that first!

### 5. Create First Admin User

```bash
cd backend
node create-admin.js
```

Follow the prompts to create your first admin user.

**If you get connection errors:**
- Check `WINDOWS_SETUP.md` for Windows-specific help
- Verify your `.env` file has correct `MONGO_URI`
- Make sure MongoDB is running (or use MongoDB Atlas)

### 6. Start Backend Server

```bash
cd backend
npm run dev
```

The backend should start on `http://localhost:5000`

### 7. Frontend Setup

```bash
# Navigate to frontend directory (in a new terminal)
cd frontend

# Install dependencies
npm install

# Start development server
npm run dev
```

The frontend should start on `http://localhost:5173`

### 8. Access the Application

1. Open `http://localhost:5173` in your browser
2. Login with the admin credentials you created
3. Start adding KYC records!

## Troubleshooting

### MongoDB Connection Error
- Ensure MongoDB is running: `mongosh` should connect
- Check `MONGO_URI` in `.env` matches your MongoDB setup
- For MongoDB Atlas, ensure your IP is whitelisted

### Redis Connection Error
- Ensure Redis is running: `redis-cli ping` should return `PONG`
- Check `REDIS_URL` in `.env`
- If Redis is not available, the anomaly detection will fail, but other features will work

### Port Already in Use
- Backend: Change `PORT` in `.env` (default: 5000)
- Frontend: Change port in `vite.config.js` (default: 5173)

### Key Generation Issues
- Ensure Node.js crypto module is available
- Run `node generate-keys.js` from the `backend` directory

### CORS Errors
- Ensure backend is running before frontend
- Check that backend CORS is configured for `http://localhost:5173`

## Production Deployment Notes

For production:
1. Use environment-specific `.env` files (never commit `.env`)
2. Use a secure key management service (AWS KMS, HashiCorp Vault)
3. Enable HTTPS/TLS
4. Use MongoDB Atlas or managed MongoDB
5. Use Redis Cloud or managed Redis
6. Set up proper logging and monitoring
7. Review and harden security settings
